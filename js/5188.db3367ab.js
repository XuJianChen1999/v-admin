"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[5188],{5188:function(e,l,a){a.r(l),a.d(l,{default:function(){return f}});var t=a(3396),o=a(4870),u=a(9242),n=a(7139),i=a(327),d={props:{column:{type:Array,default:()=>[]}},setup(e){const l=e,a=(0,o.iH)(l.column);return(e,l)=>{const o=(0,t.up)("el-tag"),u=(0,t.up)("el-table-column"),i=(0,t.up)("el-switch"),d=(0,t.up)("el-table");return(0,t.wg)(),(0,t.j4)(d,{data:a.value,"row-key":"prop",style:{width:"100%"},border:""},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{prop:"label",label:"列名"},{default:(0,t.w5)((e=>[(0,t.Wm)(o,{round:"",effect:e.row.hide?"light":"dark",type:e.row.hide?"info":""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e.row.label),1)])),_:2},1032,["effect","type"])])),_:1}),(0,t.Wm)(u,{prop:"hide",label:"显示",width:"60"},{default:(0,t.w5)((e=>[(0,t.Wm)(i,{modelValue:e.row.hide,"onUpdate:modelValue":l=>e.row.hide=l,size:"small","active-value":!1,"inactive-value":!0},null,8,["modelValue","onUpdate:modelValue"])])),_:1})])),_:1},8,["data"])}}};const p=(0,t.Uk)("导出"),r={"element-loading-text":"正在处理中..."},s={key:0,style:{position:"absolute",width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center","z-index":"3000"}},m=(0,t.Uk)("下 载");var f={props:{fileName:{type:String,default:""},apiObj:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},fileTypes:{type:Array,default:()=>["xlsx"]},column:{type:Array,default:()=>[]},blob:{type:Boolean,default:!1},progress:{type:Boolean,default:!0}},setup(e,{expose:l}){const a=e,f=(0,o.iH)(!1),c=(0,o.iH)({fileName:a.fileName,fileType:a.fileTypes[0]}),w=(0,o.iH)([]),y=(0,o.iH)(!1),b=(0,o.iH)(0);function v(){const e=a;f.value=!0,c.value={fileName:(e.fileName?e.fileName:(new Date).getTime()+"")+"."+e.fileTypes[0],fileType:e.fileTypes[0]},w.value=JSON.parse(JSON.stringify(e.column))}function g(){const e=a,l=c.value;let t={column:w.value.filter((e=>!e.hide)).map((e=>e.prop)).join(",")},o={...e.data,...l,...t};e.blob?function(e,l,a={}){y.value=!0,e.get(a,{responseType:"blob",onDownloadProgress(e){e.lengthComputable&&(b.value=parseInt(e.loaded/e.total*100))}}).then((e=>{y.value=!1,b.value=0,h("download",URL.createObjectURL(e),l)})).catch((e=>{y.value=!1,b.value=0,i.bM.error({title:"下载文件失败",message:e})}))}(e.apiObj,l.fileName,o):function(e,l,a={}){h("linkFile",e+function(e){let l=[];for(const a in e)l.push(`${a}=${e[a]}`);return(l.length>0?"?":"")+l.join("&")}(a))}(e.apiObj.url,l.fileName,o)}function h(e="linkFile",l,a){const t=document.createElement("a");t.style="display: none",t.target="_blank","download"===e&&(t.download=a),t.href=l,document.body.appendChild(t),t.click(),document.body.removeChild(t),"download"===e&&URL.revokeObjectURL(l)}return(0,t.YP)((()=>c.value.fileType),(e=>{const l=c.value.fileName;l.includes(".")?c.value.fileName=l.substring(0,l.lastIndexOf("."))+"."+e:c.value.fileName=l+"."+e})),l({close:function(){f.value=!1}}),(l,a)=>{const i=(0,t.up)("el-button"),h=(0,t.up)("el-progress"),k=(0,t.up)("el-input"),W=(0,t.up)("el-form-item"),_=(0,t.up)("el-option"),x=(0,t.up)("el-select"),N=(0,t.up)("el-form"),j=(0,t.up)("el-tab-pane"),U=(0,t.up)("el-descriptions-item"),V=(0,t.up)("el-descriptions"),T=(0,t.up)("el-tabs"),z=(0,t.up)("el-main"),O=(0,t.up)("el-drawer"),H=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.WI)(l.$slots,"default",{open:v},(()=>[(0,t.Wm)(i,{type:"primary",plain:"",onClick:v},{default:(0,t.w5)((()=>[p])),_:1})])),(0,t.Wm)(O,{modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=e=>f.value=e),title:"导出",size:400,direction:"rtl","append-to-body":"","destroy-on-close":""},{default:(0,t.w5)((()=>[(0,t.Wm)(z,{style:{padding:"0 20px 20px 20px"}},{default:(0,t.w5)((()=>[(0,t.wy)(((0,t.wg)(),(0,t.iD)("div",r,[y.value&&e.progress?((0,t.wg)(),(0,t.iD)("div",s,[(0,t.Wm)(h,{"text-inside":!0,"stroke-width":20,percentage:b.value,style:{width:"100%","margin-bottom":"120px"}},null,8,["percentage"])])):(0,t.kq)("",!0),(0,t.Wm)(T,null,{default:(0,t.w5)((()=>[(0,t.Wm)(j,{label:"常规",lazy:""},{default:(0,t.w5)((()=>[(0,t.Wm)(N,{"label-width":"100px","label-position":"left",style:{margin:"10px 0 20px 0"}},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{label:"文件名"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{modelValue:c.value.fileName,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value.fileName=e),placeholder:"请输入文件名"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(W,{label:"文件类型"},{default:(0,t.w5)((()=>[(0,t.Wm)(x,{modelValue:c.value.fileType,"onUpdate:modelValue":a[1]||(a[1]=e=>c.value.fileType=e),placeholder:"请选择文件类型"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.fileTypes,(e=>((0,t.wg)(),(0,t.j4)(_,{key:e,label:"*."+e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.WI)(l.$slots,"form",{formData:c.value})])),_:3}),(0,t.Wm)(i,{type:"primary",size:"large",icon:"el-icon-download",style:{width:"100%"},onClick:g},{default:(0,t.w5)((()=>[m])),_:1})])),_:3}),(0,t.wy)((0,t.Wm)(j,{label:"列设置",lazy:""},{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(d),{column:w.value},null,8,["column"])])),_:1},512),[[u.F8,w.value.length]]),e.data?((0,t.wg)(),(0,t.j4)(j,{key:0,label:"其他参数",lazy:""},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{column:1,border:"",size:"small"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.data,((e,l)=>((0,t.wg)(),(0,t.j4)(U,{key:l,label:l},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e),1)])),_:2},1032,["label"])))),128))])),_:1})])),_:1})):(0,t.kq)("",!0)])),_:3})])),[[H,y.value]])])),_:3})])),_:3},8,["modelValue"])],64)}}}}}]);