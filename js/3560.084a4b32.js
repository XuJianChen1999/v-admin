"use strict";(self.webpackChunkAdmin=self.webpackChunkAdmin||[]).push([[3560],{9584:function(e,t,l){l.d(t,{VO:function(){return r},af:function(){return i},y7:function(){return n}});var a=l(9805),o=l(1073);const n={url:`${o.Z.API_URL}/upload`,name:"文件上传",post:async function(e,t={}){return await a.Z.post(this.url,e,t)}},i={url:`${o.Z.API_URL}/file/list`,name:"获取文件列表",get:async function(e){return await a.Z.get(this.url,e)}},r={url:`${o.Z.API_URL}/file/menu`,name:"获取文件分类",get:async function(){return await a.Z.get(this.url)}};t.ZP={upload:{url:`${o.Z.API_URL}/upload`,name:"文件上传",post:async function(e,t={}){return await a.Z.post(this.url,e,t)}},uploadFile:{url:`${o.Z.API_URL}/uploadFile`,name:"附件上传",post:async function(e,t={}){return await a.Z.post(this.url,e,t)}},exportFile:{url:`${o.Z.API_URL}/fileExport`,name:"导出附件",get:async function(e,t={}){return console.log("this.url------",o.Z),await a.Z.get(this.url,e,t)}},importFile:{url:`${o.Z.API_URL}/fileImport`,name:"导入附件",post:async function(e,t={}){return await a.Z.post(this.url,e,t)}}}},9805:function(e,t,l){var a=l(6265),o=l.n(a),n=l(5410),i=l.n(n),r=l(4076),u=l(2807),s=l(5499),c=l(327),p=l(2111),d=l(1073),f=l(6259);let m=null;const g=new Map,w=[500,502,503,504,403,404,400,401],S={400:"请求错误",401:"登录状态失效，请重新登录",403:"拒绝访问",404:"请求地址不存在",500:"服务器繁忙",502:"网关错误",503:"服务不可用，服务器暂时过载或维护",504:"网关超时"},h='\n<path class="path" d="\n  M 30 15\n  L 28 17\n  M 25.61 25.61\n  A 15 15, 0, 0, 1, 15 30\n  A 15 15, 0, 1, 1, 27.99 7.5\n  L 15 15\n" style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>\n';function v(e){const{url:t,params:l,data:a={}}=e;return[e.method||"get",t,i().stringify(l),i().stringify(a)].join("&")}function y(e){const t=v(e);g.has(t)&&(g.get(t)(t),g.delete(t))}o().defaults.withCredentials=!0,o().defaults.timeout=d.Z.TIMEOUT,o().interceptors.request.use((e=>{const{lock:t=!0,loading:l=!0,text:a="加载中...",spinner:n=h,background:i="rgba(0, 0, 0, 0.7)"}=e;l&&(m=r.kN.service({lock:t,text:a,spinner:n,background:i})),y(e),function(e){const t=v(e);e.cancelToken=e.cancelToken||new(o().CancelToken)((e=>{g.has(t)||g.set(t,e)}))}(e);let u=(0,f.LP)();return u&&(console.log(d.Z.TOKEN_NAME),e.headers[d.Z.TOKEN_NAME]=u),d.Z.REQUEST_CACHE||"get"!==e.method||(e.params=e.params||{}),Object.assign(e.headers,d.Z.HEADERS),e}),(e=>Promise.reject(e))),o().interceptors.response.use((e=>{const{status:t,data:l}=e;if([401,403].includes(t))return(0,f.xY)(),window.location.reload(),!1;!l.flag&&u.z8.error(l.message),y(e.config);const a=setTimeout((()=>{m&&m.close(),clearTimeout(a)}),d.Z.HIDE_LOADING_TIME);return e.data}),(e=>{const t=setTimeout((()=>{m&&m.close(),clearTimeout(t)}),d.Z.HIDE_LOADING_TIME);if(e.response){const t=e.response,l=t.status;if(w.includes(l)){if([401,403].includes(l))return void s.T.confirm("当前用户已被登出或无权限访问当前资源，请尝试重新登录后再操作。","无权限访问",{type:"error",center:!0,showClose:!1,showCancelButton:!1,closeOnClickModal:!1,confirmButtonText:"重新登录"}).then((()=>{(0,f.xY)(),p.Z.replace({path:"/login"})})).catch((()=>{}));c.bM.error({title:"请求错误",message:S[l]})}else c.bM.error({title:"请求错误",message:t.data.message||`Status:${t.status}，未知错误！`})}else console.error(e),c.bM.error({title:"请求错误",message:"请求服务器无响应！"});return Promise.reject(e.response)})),t.Z=o()},3560:function(e,t,l){l.r(t),l.d(t,{default:function(){return v}});var a=l(3396),o=l(7139),n=l(4870),i=l(9242),r=l(2807),u={apiObj:l(9584).y7,successCode:200,maxSize:10,parseData:function(e){return{code:e.code,src:e.data.src,msg:e.message}}};const s={key:0,class:"upload-file"},c={class:"mask"},p=["href"],d={class:"file-empty"},f={key:0},m=(0,a.Uk)("取 消"),g=(0,a.Uk)("确 定"),w=(0,a.Uk)("取 消"),S={style:{display:"none !important"}};var h={props:{aspectRatio:{type:Number,default:NaN},compress:{type:Number,default:1},height:{type:Number,default:120},width:{type:Number,default:120},maxSize:{type:Number,default:u.maxSize},modelValue:{type:String,default:""},action:{type:String,default:""},title:{type:String,default:""},icon:{type:String,default:"el-icon-plus"},accept:{type:String,default:"image/gif, image/jpeg, image/png"},fileSelect:{type:Boolean,default:!1},cropper:{type:Boolean,default:!1},apiObj:{type:Object,default:()=>{}},onSuccess:{type:Function,default:()=>!0}},emits:["update:modelValue"],setup(e,{emit:t}){const h=e,v=(0,a.RC)((()=>Promise.all([l.e(6054),l.e(6827)]).then(l.bind(l,6827)))),y=(0,a.RC)((()=>l.e(5798).then(l.bind(l,5798)))),{cropperRef:b,uploadRef:U,loading:k,fileIsImg:_,cropperDialogVisible:I,fileSelectDialogVisible:R,img:Z,tempImg:C,cropperImg:V,style:L,showfileSelect:j,fileSelectSubmit:A,cropperSave:D,change:E,before:x,success:O,error:T,del:H,request:W}=function(e,l){const o=(0,n.iH)(null),i=(0,n.iH)(null),s=(0,n.iH)(null),c=(0,n.iH)(!1),p=(0,n.iH)(!0),d=(0,n.iH)(!1),f=(0,n.iH)(!1),m=(0,n.iH)(""),g=(0,n.iH)(""),w=(0,n.iH)(""),S=(0,n.iH)({width:`${e.width}px`,height:`${e.height}px`});function h(e){new RegExp("(.jpg|.png|.gif|.jpeg)$").test(e.toLowerCase())?p.value=!0:p.value=!1}return(0,a.YP)((()=>e.modelValue),(()=>{const t=e.modelValue;h(t),m.value=t})),(0,a.YP)(m,(()=>{return e=m.value,void t("update:modelValue",e);var e})),(0,a.bv)((()=>{const t=e.modelValue;h(t),m.value=t})),{cropperRef:i,uploadRef:o,cropperUploadFile:s,loading:c,fileIsImg:p,cropperDialogVisible:d,fileSelectDialogVisible:f,img:m,tempImg:g,cropperImg:w,style:S,showfileSelect:function(){f.value=!0},fileSelectSubmit:function(e){m.value=e,f.value=!1},cropperSave:function(){const e=o.value,t=e.upload.uploadFiles[0].raw;e.getCropFile((t=>{s.value=t,e.submit()}),t.name,t.type),d.value=!1},isImg:h,change:function(t){if(e.cropper&&"ready"===t.status){if(h(t.name),!p.value)return void(0,r.z8)({type:"warning",message:"选择的文件非图像类文件"});d.value=!0,w.value=URL.createObjectURL(t.raw)}},before:function(t){const l=e.maxSize;(t=e.cropper?s.value:t).size/1024/1024<l?(h(t.name),g.value=URL.createObjectURL(t),c.value=!0):r.z8.warning(`上传文件大小不能超过 ${l}MB!`)},success:function(t){c.value=!1,g.value="";const l=e.onSuccess(t);if(void 0!==l&&!1===l)return;const a=u.parseData(t);a.code!==u.successCode?r.z8.warning(a.msg||"上传文件未知错误"):m.value=a.src},error:function(){r.z8.error("上传文件错误"),c.value=!1,g.value="",m.value=""},del:function(){m.value=""},request:function(t){let l=u.apiObj;l.apiObj&&(l=e.apiObj);const a=new FormData,o=e.cropper?s.value:t.file;a.append("file",o),l.post(a).then((e=>{t.onSuccess(e)})).catch((e=>{t.onError(e)}))}}}(h);return(t,l)=>{const r=(0,a.up)("el-icon-delete"),u=(0,a.up)("el-icon"),h=(0,a.up)("el-image"),M=(0,a.up)("el-icon-document"),N=(0,a.up)("el-upload"),P=(0,a.up)("el-button"),$=(0,a.up)("el-dialog"),z=(0,a.up)("el-input"),q=(0,a.Q2)("loading");return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"upload","element-loading-background":"rgba(0, 0, 0, 0.5)",style:(0,o.j5)((0,n.SU)(L))},[(0,n.SU)(C)||(0,n.SU)(Z)?((0,a.wg)(),(0,a.iD)("div",s,[(0,a._)("div",c,[(0,a._)("span",{class:"del",onClick:l[0]||(l[0]=(0,i.iM)(((...e)=>(0,n.SU)(H)&&(0,n.SU)(H)(...e)),["stop"]))},[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r)])),_:1})])]),(0,n.SU)(_)?((0,a.wg)(),(0,a.j4)(h,{key:0,class:"image",src:(0,n.SU)(C)||(0,n.SU)(Z),"preview-src-list":[(0,n.SU)(Z)],fit:"cover","hide-on-click-modal":"","preview-teleported":"","z-index":9999},null,8,["src","preview-src-list"])):((0,a.wg)(),(0,a.iD)("a",{key:1,href:(0,n.SU)(Z),class:"file",target:"_blank"},[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(M)])),_:1})],8,p))])):((0,a.wg)(),(0,a.iD)("div",{key:1,class:"upload-uploader",onClick:l[1]||(l[1]=t=>e.fileSelect&&(0,n.SU)(j)())},[(0,a.Wm)(N,{ref_key:"uploadRef",ref:U,class:"uploader",disabled:e.fileSelect,"auto-upload":!e.cropper,"on-change":(0,n.SU)(E),accept:e.accept,action:e.action,"show-file-list":!1,"before-upload":(0,n.SU)(x),"on-success":(0,n.SU)(O),"on-error":(0,n.SU)(T),"http-request":(0,n.SU)(W)},{default:(0,a.w5)((()=>[(0,a.WI)(t.$slots,"default",{},(()=>[(0,a._)("div",d,[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.j4)((0,a.LL)(e.icon)))])),_:1}),e.title?((0,a.wg)(),(0,a.iD)("h4",f,(0,o.zw)(e.title),1)):(0,a.kq)("",!0)])]))])),_:3},8,["disabled","auto-upload","on-change","accept","action","before-upload","on-success","on-error","http-request"])])),(0,a.Wm)($,{title:"剪裁",modelValue:(0,n.SU)(I),"onUpdate:modelValue":l[3]||(l[3]=e=>(0,n.dq)(I)?I.value=e:null),width:580,"destroy-on-close":""},{footer:(0,a.w5)((()=>[(0,a.Wm)(P,{onClick:l[2]||(l[2]=e=>I.value=!1)},{default:(0,a.w5)((()=>[m])),_:1}),(0,a.Wm)(P,{type:"primary",onClick:(0,n.SU)(D)},{default:(0,a.w5)((()=>[g])),_:1},8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)((0,n.SU)(v),{src:(0,n.SU)(V),compress:e.compress,aspectRatio:e.aspectRatio,ref_key:"cropperRef",ref:b},null,8,["src","compress","aspectRatio"])])),_:1},8,["modelValue"]),(0,a.Wm)($,{title:"打开",modelValue:(0,n.SU)(R),"onUpdate:modelValue":l[5]||(l[5]=e=>(0,n.dq)(R)?R.value=e:null),width:880,"destroy-on-close":""},{default:(0,a.w5)((()=>[(0,a.Wm)((0,n.SU)(y),{onSubmit:(0,n.SU)(A)},{do:(0,a.w5)((()=>[(0,a.Wm)(P,{onClick:l[4]||(l[4]=e=>R.value=!1)},{default:(0,a.w5)((()=>[w])),_:1})])),_:1},8,["onSubmit"])])),_:1},8,["modelValue"]),(0,a._)("span",S,[(0,a.Wm)(z,{modelValue:(0,n.SU)(Z),"onUpdate:modelValue":l[6]||(l[6]=e=>(0,n.dq)(Z)?Z.value=e:null)},null,8,["modelValue"])])],4)),[[q,(0,n.SU)(k)]])}}},v=(0,l(89).Z)(h,[["__scopeId","data-v-094e6625"]])}}]);