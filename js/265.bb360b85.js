"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[265],{9805:function(e,l,a){var t=a(6265),o=a.n(t),r=a(5410),n=a.n(r),u=a(4076),s=a(2807),i=a(5499),d=a(327),m=a(2111),c=a(1073),p=a(6259);let f=null;const g=new Map,w=[500,502,503,504,403,404,400,401],v={400:"请求错误",401:"登录状态失效，请重新登录",403:"拒绝访问",404:"请求地址不存在",500:"服务器繁忙",502:"网关错误",503:"服务不可用，服务器暂时过载或维护",504:"网关超时"},b='\n<path class="path" d="\n  M 30 15\n  L 28 17\n  M 25.61 25.61\n  A 15 15, 0, 0, 1, 15 30\n  A 15 15, 0, 1, 1, 27.99 7.5\n  L 15 15\n" style="stroke-width: 4px; fill: rgba(0, 0, 0, 0)"/>\n';function k(e){const{url:l,params:a,data:t={}}=e;return[e.method||"get",l,n().stringify(a),n().stringify(t)].join("&")}function h(e){const l=k(e);g.has(l)&&(g.get(l)(l),g.delete(l))}o().defaults.withCredentials=!0,o().defaults.timeout=c.Z.TIMEOUT,o().interceptors.request.use((e=>{const{lock:l=!0,loading:a=!0,text:t="加载中...",spinner:r=b,background:n="rgba(0, 0, 0, 0.7)"}=e;a&&(f=u.kN.service({lock:l,text:t,spinner:r,background:n})),h(e),function(e){const l=k(e);e.cancelToken=e.cancelToken||new(o().CancelToken)((e=>{g.has(l)||g.set(l,e)}))}(e);let s=(0,p.LP)();return s&&(console.log(c.Z.TOKEN_NAME),e.headers[c.Z.TOKEN_NAME]=s),c.Z.REQUEST_CACHE||"get"!==e.method||(e.params=e.params||{}),Object.assign(e.headers,c.Z.HEADERS),e}),(e=>Promise.reject(e))),o().interceptors.response.use((e=>{const{status:l,data:a}=e;if([401,403].includes(l))return(0,p.xY)(),window.location.reload(),!1;!a.flag&&s.z8.error(a.message),h(e.config);const t=setTimeout((()=>{f&&f.close(),clearTimeout(t)}),c.Z.HIDE_LOADING_TIME);return e.data}),(e=>{const l=setTimeout((()=>{f&&f.close(),clearTimeout(l)}),c.Z.HIDE_LOADING_TIME);if(e.response){const l=e.response,a=l.status;if(w.includes(a)){if([401,403].includes(a))return void i.T.confirm("当前用户已被登出或无权限访问当前资源，请尝试重新登录后再操作。","无权限访问",{type:"error",center:!0,showClose:!1,showCancelButton:!1,closeOnClickModal:!1,confirmButtonText:"重新登录"}).then((()=>{(0,p.xY)(),m.Z.replace({path:"/login"})})).catch((()=>{}));d.bM.error({title:"请求错误",message:v[a]})}else d.bM.error({title:"请求错误",message:l.data.message||`Status:${l.status}，未知错误！`})}else console.error(e),d.bM.error({title:"请求错误",message:"请求服务器无响应！"});return Promise.reject(e.response)})),l.Z=o()},7214:function(e,l,a){a.d(l,{Ek:function(){return r},_y:function(){return o},dB:function(){return u},kD:function(){return n}}),a(1703);var t=a(4442);const o=()=>{let e=(new Date).getHours(),l="";return e>=0&&e<=10?l="早上好":e>10&&e<=14?l="中午好":e>14&&e<=18?l="下午好":e>18&&e<=24&&(l="晚上好"),l},r=e=>{if(!(0,t.Wl)(e))throw new Error("param must be a function, not "+typeof e);return e.toString().match(/function\s.*?\(([^)]*)\)/)[1].split(",").map((e=>e.replace(/\/\*.*\*\//,"").trim())).filter((e=>e))},n=()=>(new Date).getTime()+Math.random().toString(16).slice(2),u=e=>{if(!(0,t.hj)(e))throw new Error("params must be number, not "+typeof obj);return(e+="").includes(".")||(e+="."),e.replace(/(\d)(?=(\d{3})+\.)/g,(function(e,l){return l+","})).replace(/\.$/,"")}},265:function(e,l,a){a.r(l),a.d(l,{default:function(){return _}});var t=a(3396),o=a(4870),r=a(6790),n=a(6259),u=a(8439),s=a(6327),i=a(7139),d=a(2807),m=a(9805),c=a(7214);const p=(e=>((0,t.dD)("data-v-31dfe389"),e=e(),(0,t.Cn)(),e))((()=>(0,t._)("i",{class:"el-icon-plus uploader-icon"},null,-1)));var f={props:{modelValue:String},emits:["input"],setup(e,{emit:l}){const a=(0,o.iH)(!1),r=(0,o.iH)({token:"",key:""});function n(e){a.value=!1;const{key:t}=e,o=u.Cs+t;l("input",o)}function s(e){console.log(e),a.value=!1,d.z8.close(),d.z8.error("上传失败!")}function f(e){return(e=>/^image\/\w+$/i.test(e.type))(e.type)?new Promise(((l,t)=>{a.value=!0,(0,m.Z)({url:"/upload/qiniu_token"}).then((a=>{const{token:t}=a;r.value={token:t,key:(0,c.kD)()+e.name},l()})).catch((e=>{console.log(e),a.value=!1,d.z8.closel(),d.z8.error("上传失败!"),t(e)}))})):(d.z8.error("只能上传 JPG、PNG、GIF 格式!"),!1)}return(l,d)=>{const m=(0,t.up)("el-image"),c=(0,t.up)("el-upload"),g=(0,t.Q2)("loading");return(0,t.wy)(((0,t.wg)(),(0,t.j4)(c,{class:(0,i.C_)(["uploader",{"hover-mask":e.modelValue}]),"element-loading-text":"正在上传...",accept:"image/*",action:(0,o.SU)(u.GP),"show-file-list":!1,data:r.value,"on-error":s,"on-success":n,"before-upload":f},{default:(0,t.w5)((()=>[e.modelValue?((0,t.wg)(),(0,t.j4)(m,{key:0,class:"image",src:e.modelValue,fit:"cover"},null,8,["src"])):(0,t.kq)("",!0),p])),_:1},8,["action","class","data"])),[[g,a.value]])}}},g=(0,a(89).Z)(f,[["__scopeId","data-v-31dfe389"]]);const w=(0,t.Uk)("启用"),v=(0,t.Uk)("禁用"),b={class:"dialog-footer"},k=(0,t.Uk)("取消"),h=(0,t.Uk)("确定");var _={props:{modelValue:{type:Boolean,default:!1},type:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,i=(0,o.iH)(null),d=(0,o.iH)({id:"",avatar:"",name:"",fullname:"",password:"",enable:!0,role:[]}),m={avatar:[{required:!0,message:"请上传头像",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],name:[{required:!0,message:"请输入账户名",trigger:"blur"},{min:1,max:5,message:"长度在1 - 5个长度之间",trigger:"blur"}],fullname:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{min:1,max:5,message:"长度在1 - 5个长度之间",trigger:"blur"}]};function c(){l("update:modelValue",!1),i.value.resetFields()}function p(){c()}return(0,t.YP)((()=>a.modelValue),(()=>{if("edit"===a.type){const e=(0,n.rV)(u.OU);if(!Object.keys(e).length)return;const{avatar:l,enable:a,fullname:t,name:o,role:r}=e,s={password:123456,avatar:l,enable:a,fullname:t,name:o,role:r.map((e=>e.id))};d.value=s}else d.value={id:"",avatar:"",name:"",fullname:"",password:"",enable:!0,role:[]}})),(l,a)=>{const n=(0,t.up)("el-form-item"),u=(0,t.up)("el-input"),f=(0,t.up)("el-radio-button"),_=(0,t.up)("el-radio-group"),V=(0,t.up)("el-option"),y=(0,t.up)("el-select"),W=(0,t.up)("el-form"),E=(0,t.up)("el-button");return(0,t.wg)(),(0,t.j4)((0,o.SU)(s.Z),{"model-value":e.modelValue,onOnClose:c,title:"add"===e.type?"添加":"编辑"},{footer:(0,t.w5)((()=>[(0,t._)("div",b,[(0,t.Wm)(E,{onClick:c,style:{"margin-right":"10px"}},{default:(0,t.w5)((()=>[k])),_:1}),(0,t.Wm)(E,{type:"primary",onClick:p},{default:(0,t.w5)((()=>[h])),_:1})])])),default:(0,t.w5)((()=>[(0,t.Wm)(W,{ref_key:"formRef",ref:i,"label-width":"120px",model:d.value,rules:m},{default:(0,t.w5)((()=>[(0,t.Wm)(n,{label:"头像：",prop:"avatar"},{default:(0,t.w5)((()=>[(0,t.Wm)((0,o.SU)(g),{modelValue:d.value.avatar,"onUpdate:modelValue":a[0]||(a[0]=e=>d.value.avatar=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(n,{label:"账户名称：",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:d.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>d.value.name=e),placeholder:"请填写账户名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(n,{label:"真实姓名：",prop:"fullname"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:d.value.fullname,"onUpdate:modelValue":a[2]||(a[2]=e=>d.value.fullname=e),placeholder:"请填写真实姓名"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(n,{label:"密码：",prop:"password"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{modelValue:d.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>d.value.password=e),type:"password",placeholder:"请填写密码"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(n,{label:"状态：",prop:"enable"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{modelValue:d.value.enable,"onUpdate:modelValue":a[4]||(a[4]=e=>d.value.enable=e),size:"large"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{label:!0},{default:(0,t.w5)((()=>[w])),_:1}),(0,t.Wm)(f,{label:!1},{default:(0,t.w5)((()=>[v])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(n,{label:"角色：",prop:"role"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{modelValue:d.value.role,"onUpdate:modelValue":a[5]||(a[5]=e=>d.value.role=e),multiple:"",placeholder:"请选择角色"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,o.SU)(r.roles),(e=>((0,t.wg)(),(0,t.j4)(V,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["model-value","title"])}}}}}]);